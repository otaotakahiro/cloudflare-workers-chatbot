# ペルソナ管理システム

このディレクトリは、チャットボットのペルソナ設定を個別フォルダで管理し、WEB検索による最新情報で拡充できるシステムです。

## 🗂️ ディレクトリ構造

```
src/Worker/personas/
├── index.ts                           # 中央管理レジストリ
├── README.md                          # このファイル
├── persona-template/                  # 新規作成用テンプレート
│   ├── base-persona.ts
│   ├── web-context.ts
│   ├── index.ts
│   └── README.md
├── 001-g-dragon/                      # G-Dragon用設定
│   ├── base-persona.ts                # 基本ペルソナ設定
│   ├── web-context.ts                 # WEB検索による追加情報
│   └── index.ts                       # 統合設定
├── 002-tajima-shogo/                  # 田島将吾用設定
│   ├── base-persona.ts
│   ├── web-context.ts
│   └── index.ts
└── 003-nct-mark/                      # NCT Mark用設定
    ├── base-persona.ts
    └── index.ts                       # WEBコンテキストなしの基本版
```

## 🚀 新しいペルソナの追加

詳細な手順は `persona-template/README.md` を参照してください。

### 簡易版手順
1. **フォルダ作成**: `004-new-idol-name/`
2. **テンプレートコピー**: `persona-template/` からファイルをコピー
3. **設定編集**: 各ファイルの内容を実際のペルソナ情報に更新
4. **レジストリ登録**: `index.ts` に新しいペルソナを追加
5. **フロントエンド更新**: `src/Client/` 側の設定も更新

## 🎯 システムの特徴

### 二層構造のペルソナ設定
- **基本ペルソナ** (`base-persona.ts`): 固定的な性格・話し方設定
- **WEBコンテキスト** (`web-context.ts`): 最新ニュース・活動情報

### 拡張可能な設計
- **個別フォルダ管理**: 各アイドルが独立したフォルダで管理
- **番号付き命名**: 将来の大量追加に対応した命名規則
- **テンプレート提供**: 統一された品質での新規追加

### 型安全性
- **TypeScript完全対応**: 全設定項目が型チェックされる
- **インターフェース統一**: 一貫したデータ構造

## 📊 ペルソナ管理機能

### 中央レジストリ (`index.ts`)
```typescript
// 基本ペルソナアクセス（レガシー対応）
PERSONA_TEMPLATES['g-dragon']

// 拡張ペルソナアクセス（WEB情報込み）
ENHANCED_PERSONA_CONFIGS['g-dragon']

// 最適な設定自動選択
getBestPersonaConfig('g-dragon')

// WEB対応チェック
hasWebContext('g-dragon')  // true
```

### ペルソナ登録情報
```typescript
interface PersonaRegistration {
  id: string;               // 'g-dragon'
  folderNumber: string;     // '001'
  hasWebContext: boolean;   // WEB情報の有無
  lastUpdated: string;      // 最終更新日
}
```

## 🔧 WEBコンテキスト活用

### 拡充可能な情報カテゴリ
- **最新ニュース**: リリース、受賞、コラボ等
- **今後の予定**: コンサート、メディア出演等
- **個人的近況**: SNS投稿、インタビュー等
- **業界ポジション**: トレンド、影響力等
- **実績・受賞歴**: チャート成績、アワード等
- **コラボレーション**: 他アーティスト・ブランドとの連携

### 信頼性管理
- **high**: 公式発表、メジャーメディア
- **medium**: 業界ニュースサイト
- **low**: 噂、未確認情報

### 重要度設定
- **high**: そのアイドルにとって重要
- **medium**: 業界全体に関わる
- **low**: 一般的な活動報告

## 🤖 システムプロンプト生成

### 拡張ペルソナ対応
WEBコンテキスト付きペルソナは専用の詳細プロンプトを生成：
- 最新情報を含む詳細な人物設定
- 話し方の特徴をより具体的に反映
- 業界ポジションや近況を踏まえた応答指示

### フォールバック機能
WEBコンテキストがない場合は基本ペルソナで応答：
- 従来の基本設定による安定した動作
- 段階的なWEB対応移行が可能

## 📈 スケーラビリティ

### 大量ペルソナ対応
- **個別フォルダ**: ファイル競合なしで並行開発可能
- **番号管理**: 001, 002, 003... で順序管理
- **モジュラー設計**: 必要な機能のみ追加可能

### メンテナンス性
- **バージョン管理**: 基本設定とWEB情報を個別にバージョン管理
- **更新頻度調整**: WEB情報は月1回、基本設定は必要時のみ
- **テンプレート統一**: 品質の統一と開発効率向上

## 🔄 運用フロー

### 定期メンテナンス
1. **月次**: WEBコンテキスト情報の更新
2. **四半期**: システム全体の見直し
3. **必要時**: 基本ペルソナ設定の調整

### 新規ペルソナ追加
1. **計画**: ペルソナ仕様の決定
2. **開発**: テンプレートベースで実装
3. **テスト**: 動作確認とチューニング
4. **リリース**: 本番環境への展開

## ⚠️ 注意事項

### 法的配慮
- 実在人物の肖像権・著作権遵守
- 事実に基づく情報のみ使用
- 誤解を招く表現の回避

### 品質管理
- 十分なテスト実施
- 他ペルソナとの一貫性維持
- 定期的な情報更新

### セキュリティ
- WEB情報の信頼性検証
- 不適切な内容のフィルタリング
- プライバシー情報の適切な取扱い

このシステムにより、アイドルチャットボットの質を大幅に向上させ、常に最新の情報を反映した自然な対話を実現できます。
